clear;
close all;

Fs = 44.1e3;              % Original sampling frequency
n = (0:1023*64)';            % 1024 samples, 0.0232 sec signal
x = sin(2*pi*1e3/Fs*n);


x = [0,0,0,0,0.0401187912,0.211097777,0.634995461,1.46296704,2.89510202,5.18205929,8.60021877,13.4744749,20.1814346,29.1157875,40.7206421,55.4705811,73.8764801,96.4990386,123.933388,156.81337,195.828583,241.547684,294.358337,354.567963,422.410156,497.957062,581.12384,671.76178,769.562072,874.061523,984.758056,1100.98743,1222.00732,1346.9668,1474.849,1604.54895,1734.84558,1864.32581,1991.70361,2115.95068,2236.07959,2351.15137,2460.42627,2563.31787,2659.28979,2747.98853,2829.19507,2902.71045,2968.5376,3026.71387,3077.39551,3120.94702,3157.76978,3188.39575,3213.60034,3234.09033,3250.38745,3263.07764,3272.7373,3279.81738,3284.77002,3287.99536,3289.8313,3290.63892,3290.75439,3290.40479,3289.87256,3289.354,3288.9209,3288.73242,3288.83643,3289.16528,3289.70532,3290.47974,3291.40576,3292.45581,3293.64551,3294.87817,3296.18848,3297.54517,3298.823,3299.97681,3300.9541,3301.64722,3302.03345,3302.12305,3301.81396,3301.13232,3300.07568,3298.59326,3296.72705,3294.56836,3292.12744,3289.42456,3286.5647,3283.50952,3280.32739,3277.12207,3273.90771,3270.77832,3267.81152,3265.03809,3262.51489,3260.31616,3258.41382,3256.86768,3255.7168,3254.87646,3254.32227,3254.03784,3253.98999,3254.16846,3254.58521,3255.17993,3255.93628,3256.85107,3257.85791,3258.96143,3260.11621,3261.22339];

R = 16;
N = 4;
M = 17;
f = cicdesign(R, N, M);
y_1 = cicfilter(f, x);
% plot(kk/(R*M)^N);
y_2 = CIC_filter(x, length(x), N, R, M);

subplot(3,1,1);
plot(y_1);
subplot(3,1,2);
plot(y_1 / (R*M)^N);
subplot(3,1,3);
plot(y_2);
